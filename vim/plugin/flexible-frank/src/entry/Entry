" vim:set ft=vim:

python <<EOM

class Entry:

	def __init__(self, root, path):
		self.num = Num.createAndNext()
		self.path = path
		self.depth = Depth(root, path)
		self.point = Point()
		self.fold = Fold()

	def getSubs(self):
		return self._subs()

	def _subs(self):
		return self.entries if self.type.isDir() else []

	def _subfiles(self):
		return [e for e in self.entries if e.type.isFile()] if self.type.isDir() else []

	def getOutputs(self, result):
		result.append(self._createOutput())
		if not self.fold.isOn():
			[e.getOutputs(result) for e in self._subs()]
		return result

	def pointOn(self):
		self.point.on()

	def pointOff(self):
		self.point.off()

	def foldOn(self):
		self.fold.on()
		[e.fold.on() for e in self._subfiles()]

	def foldOff(self):
		self.fold.off()
		[e.fold.off() for e in self._subfiles()]

	def recFoldOn(self):
		self.fold.on()
		[e.recFoldOn() for e in self._subs()]

	def recFoldOff(self):
		self.fold.off()
		[e.recFoldOff() for e in self._subs()]

	def reNumbering(self):
		self._createAndNext()
		if self.fold.isOn():
			[e._createNotOutput() for e in self._subs()]
		else:
			[e.reNumbering() for e in self._subs()]

	def _createAndNext(self):
		self.num = Num.createAndNext()

	def _createNotOutput(self):
		self.num = Num.createNotOutput()
		[e._createNotOutput() for e in self._subs()]

	def __iter__(self):
		return self._generator()

	def _generator(self):
		yield self
		for subEntry in self._subs():
			for eachSubEntry in subEntry._generator():
				yield eachSubEntry

	def dump(self):
		self._dump()
		[e.dump() for e in self._subs()]

	def _dump(self):
		print '%s %2d : %s' % ('-' if self.fold.isOn() else '+', self.num.value, self.path.value)

EOM
